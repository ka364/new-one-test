# HADEROS Critical Security Alerts
# Rule: Detect Critical Security Events

name: "HADEROS Critical Security Alert"
type: any

# =============================================================================
# Index Pattern
# =============================================================================
index: haderos-security-alerts-*

# =============================================================================
# Query Filter
# =============================================================================
filter:
  - query:
      bool:
        should:
          - match:
              security_severity: "critical"
          - match:
              tags: "security_alert"
        minimum_should_match: 2

# =============================================================================
# Alert Conditions
# =============================================================================
realert:
  minutes: 5

# =============================================================================
# Alert Content
# =============================================================================
alert_subject: "[CRITICAL] HADEROS Security Alert: {0}"
alert_subject_args:
  - tags

alert_text: |
  HADEROS Security Alert Detected!

  Severity: {0}
  Tags: {1}
  Message: {2}
  Timestamp: {3}
  Host: {4}

  ---
  This alert was generated by HADEROS SIEM.
  Please investigate immediately.

alert_text_args:
  - security_severity
  - tags
  - message
  - "@timestamp"
  - host.name

# =============================================================================
# Alert Methods
# =============================================================================
alert:
  - debug
  # Uncomment below for production:
  # - email
  # - slack

# Email settings (if enabled)
# email:
#   - security@haderos.io

# Slack settings (if enabled)
# slack_webhook_url: "https://hooks.slack.com/services/XXX/YYY/ZZZ"
# slack_channel_override: "#security-alerts"
