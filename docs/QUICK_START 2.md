#!/bin/bash

###############################################################################
# HaderOS Platform - Quick Reference Guide
# دليل سريع لتشغيل النظام محليًا
###############################################################################

echo "
╔════════════════════════════════════════════════════════════════════════════╗
║                  🚀 HaderOS Platform - Quick Setup Guide                  ║
╚════════════════════════════════════════════════════════════════════════════╝

📋 STEP 1: التحقق من المتطلبات الأساسية
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

تحقق من أن لديك:
  ✅ Python 3.9+  → اكتب: python3 --version
  ✅ Node.js 20+  → اكتب: node --version
  ✅ npm/pnpm     → اكتب: npm --version
  ✅ Git          → اكتب: git --version

إذا لم تكن مثبتة:
  macOS:   brew install python@3.11 node
  Ubuntu:  sudo apt install python3.11 nodejs npm
  Windows: حمّل من python.org و nodejs.org

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📋 STEP 2: الإعداد الأول (مرة واحدة فقط)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  \$ chmod +x run.sh          # اجعل الـ script قابل للتنفيذ
  \$ bash run.sh setup        # تثبيت كل شيء

ماذا يحدث؟
  ✅ ينشئ Python virtual environment
  ✅ يثبت المكتبات من requirements.txt
  ✅ يثبت مكتبات Node من package.json
  ✅ ينشئ قاعدة بيانات SQLite محلية
  ✅ ينشئ ملف .env بالإعدادات الافتراضية

المدة المتوقعة: 5-10 دقائق

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🚀 STEP 3: التشغيل (يومياً)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

الطريقة الأولى (الموصى بها):
  \$ bash run.sh both

الطريقة الثانية (في نافذتين منفصلتين):
  نافذة 1: \$ bash run.sh backend
  نافذة 2: \$ bash run.sh frontend

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🌐 الوصول إلى التطبيق
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

بعد التشغيل، افتح في المتصفح:

  🖥️  التطبيق (Frontend)
      http://localhost:3000

  🔧 API (Backend)
      http://localhost:8000

  📚 توثيق API
      http://localhost:8000/api/docs

  🏥 صحة النظام
      http://localhost:8000/health

  📊 الإحصائيات
      http://localhost:8000/metrics

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💾 الملفات المهمة
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  📄 .env                    الإعدادات المحلية (لا تُرسل إلى Git)
  🐍 backend/                كود FastAPI
  ⚛️  haderos-mvp/           كود React
  🗄️  haderos_dev.db         قاعدة البيانات المحلية
  📋 run.sh                  script التشغيل الرئيسي

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🛠️ أوامر مفيدة
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  bash run.sh help          # عرض المساعدة الكاملة
  bash run.sh clean         # حذف المكتبات والملفات المؤقتة
  bash run.sh reset-db      # حذف قاعدة البيانات (لبدء جديد)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🌍 العمل بدون إنترنت
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ بعد التثبيت الأول، يعمل كل شيء بدون إنترنت!

جميع الميزات التالية تعمل محليًا:
  ✅ جميع API endpoints
  ✅ قاعدة البيانات (SQLite)
  ✅ Bio-Modules والذكاء الاصطناعي
  ✅ التحقق من Sharia compliance
  ✅ تقييم المخاطر
  ✅ التسعير الديناميكي
  ✅ جميع الميزات الأخرى

ما قد يحتاج إنترنت (اختياري):
  ⚠️  OpenAI ChatGPT (يمكن تعطيله)
  ⚠️  الاتصال بـ Blockchain (يمكن محاكاته)
  ⚠️  خدمات خارجية (اختيارية)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

❓ حل المشاكل الشائعة
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

❌ خطأ: Port already in use
✅ الحل:
   # إيجاد العملية وإيقافها
   lsof -i :3000
   kill -9 <PID>

❌ خطأ: Module not found
✅ الحل:
   bash run.sh clean
   bash run.sh setup

❌ خطأ: Database is locked
✅ الحل:
   bash run.sh reset-db
   bash run.sh backend

❌ خطأ: Command not found
✅ الحل:
   # تأكد من تثبيت Python و Node
   python3 --version
   node --version

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🐳 خيار إضافي: استخدام Docker
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

إذا كان لديك Docker مثبت:

  \$ docker-compose -f docker-compose.dev.yml up

يعمل تلقائياً على:
  http://localhost:3000  (Frontend)
  http://localhost:8000  (Backend)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📖 معلومات إضافية
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📖 دليل شامل: اقرأ LOCAL_SETUP.md
🔧 للمزيد عن run.sh: bash run.sh help
🐍 تفاصيل Backend: backend/main.py
⚛️  تفاصيل Frontend: haderos-mvp/src/App.tsx

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✨ أنت جاهز الآن!
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

ابدأ الآن:
  \$ bash run.sh setup
  \$ bash run.sh both

ثم افتح: http://localhost:3000

🎉 Happy Coding!
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

"
