# HADEROS Elastalert2 Configuration
# Security Alerting Engine

# =============================================================================
# Elasticsearch Connection
# =============================================================================
es_host: elasticsearch
es_port: 9200
es_username: elastic
es_password: ${ES_PASSWORD}
use_ssl: false
verify_certs: false

# =============================================================================
# Alert Configuration
# =============================================================================
rules_folder: /opt/elastalert/rules
run_every:
  minutes: 1
buffer_time:
  minutes: 15

# =============================================================================
# Alert Storage
# =============================================================================
writeback_index: haderos-elastalert-status
writeback_alias: haderos-elastalert-status

# =============================================================================
# Alert Limits
# =============================================================================
alert_time_limit:
  days: 2

# =============================================================================
# Notifications
# =============================================================================
# Email Configuration (uncomment and configure)
# smtp_host: smtp.gmail.com
# smtp_port: 587
# smtp_ssl: false
# from_addr: alerts@haderos.io
# smtp_auth_file: /opt/elastalert/smtp_auth.yaml

# Slack Configuration (uncomment and configure)
# slack_webhook_url: https://hooks.slack.com/services/XXX/YYY/ZZZ
# slack_channel_override: "#security-alerts"
# slack_username_override: "HADEROS Security"
# slack_emoji_override: ":shield:"

# =============================================================================
# Logging
# =============================================================================
logging:
  version: 1
  disable_existing_loggers: false
  formatters:
    standard:
      format: '%(asctime)s [%(levelname)s] %(name)s: %(message)s'
  handlers:
    console:
      class: logging.StreamHandler
      level: INFO
      formatter: standard
      stream: ext://sys.stdout
    file:
      class: logging.FileHandler
      level: DEBUG
      formatter: standard
      filename: /opt/elastalert/logs/elastalert.log
  loggers:
    elastalert:
      level: INFO
      handlers: [console, file]
      propagate: false
    elasticsearch:
      level: WARNING
      handlers: [console]
      propagate: false
