# ๐ ููุฎุต ุชูุงูู Handsontable ูุน HADEROS

## โ **ุชู ุงูุงูุชูุงุก ุจูุฌุงุญ!**

ุชู ุจูุฌุงุญ ุฏูุฌ **Handsontable** - ุฃููู ููุชุจุฉ ุฌุฏุงูู ุจูุงูุงุช ููุชูุญุฉ ุงููุตุฏุฑ - ูุน ูุธุงู HADEROS ูุชูููุฑ ุชุฌุฑุจุฉ Excel/Google Sheets ูุงููุฉ ุฏุงุฎู ุงููุธุงู.

---

## ๐ ุงููููุงุช ุงููููุดุฃุฉ (4 ูููุงุช)

### 1. **Schema ูุงุนุฏุฉ ุงูุจูุงูุงุช** (9.6 KB)
```
drizzle/schema-spreadsheet-collab.ts
```

**7 ุฌุฏุงูู ุฌุฏูุฏุฉ:**
- โ `spreadsheet_sessions` - ุฌูุณุงุช ุงูุฌุฏุงูู
- โ `cell_comments` - ุชุนูููุงุช ุงูุฎูุงูุง ูุน ุงูุฑุฏูุฏ
- โ `spreadsheet_versions` - ุชุงุฑูุฎ ุงูุฅุตุฏุงุฑุงุช ุงููุงูู
- โ `spreadsheet_sharing` - ุงููุดุงุฑูุฉ ูุงูุตูุงุญูุงุช
- โ `spreadsheet_edits` - ุงูุชุญุฑูุฑ ุงูุชุนุงููู
- โ `spreadsheet_formulas` - ุงูุตูุบ ุงูุญุณุงุจูุฉ
- โ `spreadsheet_charts` - ุงููุฎุทุทุงุช ุงูุจูุงููุฉ

**ุงูููุฒุงุช:**
- โ Foreign Keys ููุณูุงูุฉ
- โ Indexes ูุญุณููุฉ (GIN, BTREE)
- โ Zod Schemas ููุชุญูู
- โ Relations ูุงููุฉ

---

### 2. **tRPC Router** (13.8 KB)
```
server/routers/spreadsheet-collab.ts
```

**26 API Endpoint:**

#### Session Management (4 endpoints)
- `createSession` - ุฅูุดุงุก ุฌูุณุฉ ุฌุฏูู ุฌุฏูุฏุฉ
- `getSession` - ุงูุญุตูู ุนูู ุฌูุณุฉ ูุญุฏุฏุฉ
- `getSessions` - ุงูุญุตูู ุนูู ุฌููุน ุงูุฌูุณุงุช
- `updateSession` - ุชุญุฏูุซ ุฌูุณุฉ

#### Comments (5 endpoints)
- `addComment` - ุฅุถุงูุฉ ุชุนููู ุนูู ุฎููุฉ
- `getComments` - ุงูุญุตูู ุนูู ุชุนูููุงุช ุฌูุณุฉ
- `resolveComment` - ุญู ุชุนููู
- `deleteComment` - ุญุฐู ุชุนููู
- `replyToComment` - ุงูุฑุฏ ุนูู ุชุนููู

#### Version History (5 endpoints)
- `createVersion` - ุฅูุดุงุก ูุณุฎุฉ ุฌุฏูุฏุฉ
- `getVersions` - ุงูุญุตูู ุนูู ุชุงุฑูุฎ ุงูุฅุตุฏุงุฑุงุช
- `getVersion` - ุงูุญุตูู ุนูู ูุณุฎุฉ ูุญุฏุฏุฉ
- `restoreVersion` - ุงุณุชุนุงุฏุฉ ูุณุฎุฉ ุณุงุจูุฉ
- `compareVersions` - ููุงุฑูุฉ ูุณุฎุชูู

#### Sharing & Permissions (5 endpoints)
- `share` - ูุดุงุฑูุฉ ุฌุฏูู ูุน ูุณุชุฎุฏู
- `getSharing` - ุงูุญุตูู ุนูู ุงููุณุชุฎุฏููู ุงููุดุงุฑููู
- `updatePermission` - ุชุญุฏูุซ ุตูุงุญูุงุช ูุณุชุฎุฏู
- `revokeSharing` - ุฅูุบุงุก ูุดุงุฑูุฉ
- `checkPermission` - ุงูุชุญูู ูู ุตูุงุญูุฉ

#### Formulas (3 endpoints)
- `addFormula` - ุฅุถุงูุฉ ุตูุบุฉ ุญุณุงุจูุฉ
- `getFormulas` - ุงูุญุตูู ุนูู ุตูุบ ุฌูุณุฉ
- `deleteFormula` - ุญุฐู ุตูุบุฉ

#### Charts (4 endpoints)
- `createChart` - ุฅูุดุงุก ูุฎุทุท
- `getCharts` - ุงูุญุตูู ุนูู ูุฎุทุทุงุช ุฌูุณุฉ
- `updateChart` - ุชุญุฏูุซ ูุฎุทุท
- `deleteChart` - ุญุฐู ูุฎุทุท

---

### 3. **React Component** (15.2 KB)
```
src/components/expenses/AdvancedHandsontableSpreadsheet.tsx
```

**ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ:**

#### โ **ุชุฌุฑุจุฉ Excel ูุงููุฉ**
- ุชุญุฑูุฑ ูุจุงุดุฑ ูู ุงูุฎูุงูุง
- Copy/Paste ูู ูุฅูู Excel
- Drag & Fill
- Undo/Redo
- Sorting & Filtering
- Column/Row Resizing
- Context Menu

#### โ **ุงูุตูุบ ุงูุญุณุงุจูุฉ**
- `=SUM(B2:B10)` - ูุฌููุน
- `=AVERAGE(B2:B10)` - ูุชูุณุท
- `=COUNT(B2:B10)` - ุนุฏุฏ
- `=A2*0.15` - ุนูููุงุช ุญุณุงุจูุฉ
- ุฅุนุงุฏุฉ ุญุณุงุจ ุชููุงุฆู

#### โ **ุงูุชุนูููุงุช**
- ุฅุถุงูุฉ ุชุนูููุงุช ุนูู ุฃู ุฎููุฉ
- 4 ุฃููุงุน: ููุงุญุธุฉุ ุณุคุงูุ ุชุญุฐูุฑุ ุฎุทุฃ
- ุฑุฏูุฏ ุนูู ุงูุชุนูููุงุช (Threading)
- ุฐูุฑ ูุณุชุฎุฏููู (@mentions)
- ุญู ุงูุชุนูููุงุช

#### โ **ุชุงุฑูุฎ ุงูุฅุตุฏุงุฑุงุช**
- ุญูุธ ุชููุงุฆู ููู ุชุบููุฑ
- ุนุฑุถ ุฌููุน ุงูุฅุตุฏุงุฑุงุช
- ุงุณุชุนุงุฏุฉ ุฃู ูุณุฎุฉ
- ููุงุฑูุฉ ุจูู ุงูุฅุตุฏุงุฑุงุช

#### โ **ุงููุดุงุฑูุฉ ูุงูุชุนุงูู**
- ูุดุงุฑูุฉ ูุน ุงููุฑูู
- 4 ูุณุชููุงุช ุตูุงุญูุงุช:
  - ๐๏ธ **view** - ุนุฑุถ ููุท
  - ๐ฌ **comment** - ุนุฑุถ ูุชุนููู
  - โ๏ธ **edit** - ุชุญุฑูุฑ
  - ๐ **admin** - ุฅุฏุงุฑุฉ ูุงููุฉ
- ุชุชุจุน ุงููุตูู
- ุงูุชูุงุก ุตูุงุญูุฉ

#### โ **ุงููุฎุทุทุงุช ุงูุจูุงููุฉ**
- ๐ ุฃุนูุฏุฉ (Bar)
- ๐ ุฎุทู (Line)
- ๐ฅง ุฏุงุฆุฑู (Pie)
- ๐ ูุณุงุญู (Area)
- ุชุญุฏูุซ ุชููุงุฆู

#### โ **ุงูุงุณุชูุฑุงุฏ ูุงูุชุตุฏูุฑ**
- ุชุตุฏูุฑ ุฅูู Excel (.xlsx)
- ุชุตุฏูุฑ ุฅูู CSV
- ุงุณุชูุฑุงุฏ ูู Excel
- ุงุณุชูุฑุงุฏ ูู CSV

---

### 4. **ุงููุซุงุฆู ุงูุดุงููุฉ** (12.5 KB)
```
HANDSONTABLE_INTEGRATION_GUIDE.md
```

**ุงููุญุชููุงุช:**
- โ ูุธุฑุฉ ุนุงูุฉ ุนูู ุงูููุฒุงุช
- โ ุฎุทูุงุช ุงูุชุซุจูุช ูุงูุฅุนุฏุงุฏ
- โ ุฃูุซูุฉ ุงุณุชุฎุฏุงู ุดุงููุฉ
- โ ุงูุชุฎุตูุต ูุงูุฅุนุฏุงุฏุงุช
- โ ุงูุฃูุงู ูุงูุตูุงุญูุงุช
- โ ุงูุฃุฏุงุก ูุงูุชุญุณูู
- โ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก
- โ ุงูููุงุฑุฏ ุงูุฅุถุงููุฉ

---

## ๐ ุงูุฅุญุตุงุฆูุงุช

| ุงููููุงุณ | ุงููููุฉ |
|---------|--------|
| **ุงููููุงุช ุงููููุดุฃุฉ** | 4 ูููุงุช |
| **ุญุฌู ุงูููุฏ** | ~51 KB |
| **ุฌุฏุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช** | 7 ุฌุฏุงูู |
| **API Endpoints** | 26 endpoint |
| **React Components** | 1 ูููู ูุชูุฏู |
| **ุฃุณุทุฑ ุงูููุฏ** | ~2,200 ุณุทุฑ |
| **ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ** | 7 ููุฒุงุช |
| **ูุณุชููุงุช ุงูุตูุงุญูุงุช** | 4 ูุณุชููุงุช |

---

## ๐ ุงูููุฒุงุช ุงูููููุฐุฉ

### 1. โ **ุชุฌุฑุจุฉ Excel ูุงููุฉ**
- ุชุญุฑูุฑ ูุจุงุดุฑ
- Copy/Paste
- Drag & Fill
- Undo/Redo
- Sorting & Filtering

### 2. โ **ุงูุตูุบ ุงูุญุณุงุจูุฉ**
- ุตูุบ Excel ุงูููุงุณูุฉ
- ุนูููุงุช ุญุณุงุจูุฉ
- ูุฑุงุฌุน ุงูุฎูุงูุง
- ุฅุนุงุฏุฉ ุญุณุงุจ ุชููุงุฆู

### 3. โ **ุงูุชุนูููุงุช**
- ุชุนูููุงุช ุนูู ุงูุฎูุงูุง
- ุฃููุงุน ูุชุนุฏุฏุฉ
- ุฑุฏูุฏ (Threading)
- ุฐูุฑ ูุณุชุฎุฏููู
- ุญู ุงูุชุนูููุงุช

### 4. โ **ุชุงุฑูุฎ ุงูุฅุตุฏุงุฑุงุช**
- ุญูุธ ุชููุงุฆู
- ุนุฑุถ ุงูุฅุตุฏุงุฑุงุช
- ุงุณุชุนุงุฏุฉ ุงููุณุฎ
- ููุงุฑูุฉ ุงูุฅุตุฏุงุฑุงุช

### 5. โ **ุงููุดุงุฑูุฉ ูุงูุชุนุงูู**
- ูุดุงุฑูุฉ ูุน ุงููุฑูู
- ุตูุงุญูุงุช ูุชุนุฏุฏุฉ
- ุชุชุจุน ุงููุตูู
- ุงูุชูุงุก ุงูุตูุงุญูุฉ

### 6. โ **ุงููุฎุทุทุงุช ุงูุจูุงููุฉ**
- 4 ุฃููุงุน ูุฎุทุทุงุช
- ุชุญุฏูุซ ุชููุงุฆู
- ุชุฎุตูุต ูุงูู

### 7. โ **ุงูุงุณุชูุฑุงุฏ ูุงูุชุตุฏูุฑ**
- Excel (.xlsx)
- CSV
- ุงุณุชูุฑุงุฏ ูุชุตุฏูุฑ

---

## ๐ฏ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู

### 1. **ุฅุฏุงุฑุฉ ุงููุตุฑููุงุช**
```typescript
<AdvancedHandsontableSpreadsheet
  hierarchyPath="1.3.5"
  stakeholderName="ูุตูุน ุงูุฅููุชุฑูููุงุช"
  sessionId="expenses-jan-2025"
/>
```

### 2. **ุฅุฏุงุฑุฉ ุงูููุฒุงููุงุช**
```typescript
<AdvancedHandsontableSpreadsheet
  hierarchyPath="1.3"
  stakeholderName="ูุณู ุงูุชุณููู"
  sessionId="budget-2025"
/>
```

### 3. **ุฅุฏุงุฑุฉ ุงูุงุดุชุฑุงูุงุช**
```typescript
<AdvancedHandsontableSpreadsheet
  hierarchyPath="1"
  stakeholderName="ุงูุดุฑูุฉ"
  sessionId="subscriptions-tech"
/>
```

---

## ๐ ุงูุฃูุงู

### ูุณุชููุงุช ุงูุตูุงุญูุงุช

| ุงูุตูุงุญูุฉ | ุงูุนุฑุถ | ุงูุชุนููู | ุงูุชุญุฑูุฑ | ุงูุญุฐู | ุงูุชุตุฏูุฑ | ุงููุดุงุฑูุฉ |
|----------|-------|---------|---------|--------|---------|----------|
| **view** | โ | โ | โ | โ | โ | โ |
| **comment** | โ | โ | โ | โ | โ | โ |
| **edit** | โ | โ | โ | โ | โ | โ |
| **admin** | โ | โ | โ | โ | โ | โ |

### ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
- โ ุนูู ูุณุชูู API (tRPC)
- โ ุนูู ูุณุชูู Component (React)
- โ ุนูู ูุณุชูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (RLS)

---

## โก ุงูุฃุฏุงุก

### ุงูุชุญุณููุงุช ุงูููุทุจูุฉ

1. โ **Virtualization** - ุชุญููู ุงูุตููู ุงููุฑุฆูุฉ ููุท
2. โ **Lazy Loading** - ุชุญููู ุงูุจูุงูุงุช ุชุฏุฑูุฌูุงู
3. โ **Debouncing** - ุชุฃุฎูุฑ ุงูุญูุธ ุงูุชููุงุฆู
4. โ **Indexing** - ููุงุฑุณ ูุญุณููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
5. โ **Caching** - ุชุฎุฒูู ูุคูุช ููุจูุงูุงุช

### ุงูุฃุฏุงุก ุงููุชููุน

| ุญุฌู ุงูุจูุงูุงุช | ููุช ุงูุชุญููู | ุงูุฐุงูุฑุฉ ุงููุณุชุฎุฏูุฉ |
|--------------|-------------|-------------------|
| 100 ุตู | < 1 ุซุงููุฉ | ~5 MB |
| 1,000 ุตู | < 2 ุซุงููุฉ | ~20 MB |
| 10,000 ุตู | < 5 ุซูุงูู | ~100 MB |

---

## ๐ฆ ุงูุชุจุนูุงุช ุงููุทููุจุฉ

```json
{
  "dependencies": {
    "handsontable": "^14.0.0",
    "@handsontable/react": "^14.0.0",
    "xlsx": "^0.18.5",
    "file-saver": "^2.0.5",
    "@radix-ui/react-dialog": "^1.0.5",
    "@radix-ui/react-tabs": "^1.0.4",
    "sonner": "^1.3.1"
  }
}
```

**ุญุฌู ุงูุญุฒู:**
- `handsontable`: ~1.2 MB
- `@handsontable/react`: ~50 KB
- `xlsx`: ~600 KB
- **ุงูุฅุฌูุงูู**: ~1.85 MB

---

## ๐ ุงูุชูุงูู ูุน HADEROS

### 1. **ูุน ูุธุงู ุงูุชูุณุน 7ร7**
```typescript
// ูู ููุงู ูู ุฌุฏูู ูุตุฑููุงุช ุฎุงุต
hierarchyPath: "1.3.5" // ูุตูุน ูุญุฏุฏ
```

### 2. **ูุน ูุธุงู ุงููุตุฑููุงุช**
```typescript
// ุฑุจุท ูุจุงุดุฑ ูุน ุฌุฏูู expenses
expenseId: "expense-123"
```

### 3. **ูุน ูุธุงู ุงูุตูุงุญูุงุช**
```typescript
// ุงุณุชุฎุฏุงู ูุธุงู ุงูุตูุงุญูุงุช ุงูููุฌูุฏ
permission: user.role === 'admin' ? 'admin' : 'edit'
```

---

## ๐ ุฃูุซูุฉ ุงูุงุณุชุฎุฏุงู

### ูุซุงู 1: ุฅูุดุงุก ุฌูุณุฉ ูุฅุถุงูุฉ ุจูุงูุงุช

```typescript
// 1. ุฅูุดุงุก ุฌูุณุฉ
const { mutate: createSession } = trpc.spreadsheet.createSession.useMutation();
const sessionId = await createSession({
  hierarchyPath: '1.3.5',
  hierarchyId: 'factory-123',
  name: 'ูุตุฑููุงุช ููุงูุฑ 2025',
  type: 'expenses',
});

// 2. ุนุฑุถ ุงูุฌุฏูู
<AdvancedHandsontableSpreadsheet
  hierarchyPath="1.3.5"
  stakeholderName="ูุตูุน ุงูุฅููุชุฑูููุงุช"
  sessionId={sessionId}
/>
```

### ูุซุงู 2: ุฅุถุงูุฉ ุชุนููู ูุตูุบุฉ

```typescript
// ุฅุถุงูุฉ ุชุนููู
await trpc.spreadsheet.addComment.mutate({
  sessionId,
  cellAddress: 'B5',
  rowIndex: 4,
  columnKey: 'amount',
  comment: 'ูุฑุฌู ูุฑุงุฌุนุฉ ูุฐุง ุงููุจูุบ',
  commentType: 'question',
});

// ุฅุถุงูุฉ ุตูุบุฉ
await trpc.spreadsheet.addFormula.mutate({
  sessionId,
  cellAddress: 'B11',
  rowIndex: 10,
  columnKey: 'total',
  formula: '=SUM(B2:B10)',
});
```

### ูุซุงู 3: ูุดุงุฑูุฉ ูุฅูุดุงุก ูุฎุทุท

```typescript
// ูุดุงุฑูุฉ ูุน ูุณุชุฎุฏู
await trpc.spreadsheet.share.mutate({
  sessionId,
  userEmail: 'colleague@company.com',
  permission: 'edit',
  canExport: true,
});

// ุฅูุดุงุก ูุฎุทุท
await trpc.spreadsheet.createChart.mutate({
  sessionId,
  chartType: 'bar',
  title: 'ุงููุตุฑููุงุช ุญุณุจ ุงููุฆุฉ',
  dataRange: 'A1:B10',
});
```

---

## โ ูุงุฆูุฉ ุงูุชุญูู ููุชุดุบูู

### ุงูุชุซุจูุช
- [ ] `pnpm add handsontable @handsontable/react`
- [ ] `pnpm add xlsx file-saver`
- [ ] `pnpm add @radix-ui/react-dialog @radix-ui/react-tabs`
- [ ] `pnpm add sonner`

### ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [ ] ุชุทุจูู `schema-spreadsheet-collab.ts`
- [ ] `pnpm db:push`
- [ ] ุงูุชุญูู ูู ุงูุฌุฏุงูู

### Router
- [ ] ุชุณุฌูู `spreadsheetCollabRouter` ูู `_app.ts`
- [ ] ุงุฎุชุจุงุฑ Endpoints

### Component
- [ ] ุงุณุชูุฑุงุฏ `AdvancedHandsontableSpreadsheet`
- [ ] ุงุฎุชุจุงุฑ ุงูููุฒุงุช ุงูุฃุณุงุณูุฉ
- [ ] ุงุฎุชุจุงุฑ ุงูุตูุงุญูุงุช

### ุงูุงุฎุชุจุงุฑ
- [ ] ุงูุชุญุฑูุฑ ุงููุจุงุดุฑ
- [ ] ุงูุตูุบ ุงูุญุณุงุจูุฉ
- [ ] ุงูุชุนูููุงุช
- [ ] ุชุงุฑูุฎ ุงูุฅุตุฏุงุฑุงุช
- [ ] ุงููุดุงุฑูุฉ
- [ ] ุงููุฎุทุทุงุช
- [ ] ุงูุงุณุชูุฑุงุฏ/ุงูุชุตุฏูุฑ

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ุงููุฑุญูุฉ 1: ุงูุงุฎุชุจุงุฑ ุงูุดุงูู
- [ ] ุงุฎุชุจุงุฑ ุฌููุน ุงูููุฒุงุช
- [ ] ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก ูุน ุจูุงูุงุช ูุจูุฑุฉ
- [ ] ุงุฎุชุจุงุฑ ุงูุตูุงุญูุงุช
- [ ] ุงุฎุชุจุงุฑ ุนูู ุฃุฌูุฒุฉ ูุฎุชููุฉ

### ุงููุฑุญูุฉ 2: ุงูุชุญุณููุงุช
- [ ] ุฅุถุงูุฉ Realtime Collaboration (WebSockets)
- [ ] ุชุญุณูู UX ููููุจุงูู
- [ ] ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุฃููุงุน ุงููุฎุทุทุงุช
- [ ] ุชุญุณูู ุงูุฃุฏุงุก

### ุงููุฑุญูุฉ 3: ุงูุชูุซูู
- [ ] ููุฏูููุงุช ุชุนููููุฉ
- [ ] ุฃูุซูุฉ ุฅุถุงููุฉ
- [ ] FAQ
- [ ] Best Practices

---

## ๐ ุงูุฏุนู

### ุงููุซุงุฆู
- [HANDSONTABLE_INTEGRATION_GUIDE.md](./HANDSONTABLE_INTEGRATION_GUIDE.md)
- [Handsontable Official Docs](https://handsontable.com/docs/)

### ุงููุดุงูู ุงูุดุงุฆุนุฉ
ุฑุงุฌุน ูุณู "ุงุณุชูุดุงู ุงูุฃุฎุทุงุก" ูู ุงูุฏููู ุงูุดุงูู

---

## ๐ ุงูุฎูุงุตุฉ

ุชู ุจูุฌุงุญ ุฏูุฌ **Handsontable** ูุน HADEROS ุจุฌููุน ุงูููุฒุงุช ุงููุทููุจุฉ:

โ ุชุฌุฑุจุฉ Excel ูุงููุฉ  
โ ุงูุตูุบ ุงูุญุณุงุจูุฉ  
โ ุงูุชุนูููุงุช ุนูู ุงูุฎูุงูุง  
โ ุชุงุฑูุฎ ุงูุฅุตุฏุงุฑุงุช  
โ ุงููุดุงุฑูุฉ ูุงูุชุนุงูู  
โ ุงููุฎุทุทุงุช ุงูุจูุงููุฉ  
โ ุงูุงุณุชูุฑุงุฏ ูุงูุชุตุฏูุฑ  

**ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุงูููุฑู! ๐**

---

**Commit:** `0c1372e`  
**Branch:** `main`  
**GitHub:** [ka364/haderos-mvp](https://github.com/ka364/haderos-mvp)
